import requests
import re

def get_token_id(response):
    return re.search("user_token'\s*value='(.*?)'", response.text).group(1)

def login_dvwa(session, url, user="admin", password="password", submit="Login"):
    r = session.get(url)
    payload = {
        'username': user,
        'password': password,
        submit:'Login'
    }
    payload['user_token'] = get_token_id(r)
    p = session.post(url, data=payload)
    return session
def set_dvwa_difficulty(session, url, difficulty='low'):
    payload = {
        'security':difficulty,
        'seclev_submit':'submit'
    }
    
    r = session.get(url)
    payload['user_token'] = get_token_id(r)
    
    p = session.post(url, data=payload)
    return session
    